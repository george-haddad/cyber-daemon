package org.daemon.revenant.vulnerabilities;

import jakarta.inject.Inject;
import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;
import jakarta.ws.rs.Produces;
import jakarta.ws.rs.core.MediaType;
import jakarta.ws.rs.core.Response;

@Path("/vulnerabilities")
public class VulnerabilityResource {

        @Inject
        VulnerabilityService service;

        @GET
        @Path("{id}")
        @Produces(MediaType.APPLICATION_JSON)
        public Response getVulnerability(String id) {
                System.out.println("Getting vulnerability with id: " + id);
                Vulnerability vuln = service.getVulnerability(id);
                Response res = Response.ok(vuln)
                                        .type(MediaType.APPLICATION_JSON)
                                        .build();
                return res;
        }
}
